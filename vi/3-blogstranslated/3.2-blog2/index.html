<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../../images/favicon.png type=image/png><title>Blog 2 :: Báo cáo thực tập</title>
<link href=../../../css/nucleus.css?1765283963 rel=stylesheet><link href=../../../css/fontawesome-all.min.css?1765283963 rel=stylesheet><link href=../../../css/hybrid.css?1765283963 rel=stylesheet><link href=../../../css/featherlight.min.css?1765283963 rel=stylesheet><link href=../../../css/perfect-scrollbar.min.css?1765283963 rel=stylesheet><link href=../../../css/auto-complete.css?1765283963 rel=stylesheet><link href=../../../css/atom-one-dark-reasonable.css?1765283963 rel=stylesheet><link href=../../../css/theme.css?1765283963 rel=stylesheet><link href=../../../css/hugo-theme.css?1765283963 rel=stylesheet><link href=../../../css/theme-workshop.css?1765283963 rel=stylesheet><script src=../../../js/jquery-3.3.1.min.js?1765283963></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../../vi/3-blogstranslated/3.2-blog2/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../../js/lunr.min.js?1765283963></script><script type=text/javascript src=../../../js/auto-complete.js?1765283963></script><script type=text/javascript>var baseurl="https://masterltb.github.io/profile//vi"</script><script type=text/javascript src=../../../js/search.js?1765283963></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=../../../vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Nhật ký Tuần 1" class=dd-item><a href=../../../vi/1-worklog/1.1-week1/><b>1.1. </b>Nhật ký Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Nhật ký Tuần 2" class=dd-item><a href=../../../vi/1-worklog/1.2-week2/><b>1.2. </b>Nhật ký Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Nhật ký Tuần 3" class=dd-item><a href=../../../vi/1-worklog/1.3-week3/><b>1.3. </b>Nhật ký Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Nhật ký Tuần 4" class=dd-item><a href=../../../vi/1-worklog/1.4-week4/><b>1.4. </b>Nhật ký Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Nhật ký Tuần 5" class=dd-item><a href=../../../vi/1-worklog/1.5-week5/><b>1.5. </b>Nhật ký Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Nhật ký Tuần 6" class=dd-item><a href=../../../vi/1-worklog/1.6-week6/><b>1.6. </b>Nhật ký Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Nhật ký Tuần 7" class=dd-item><a href=../../../vi/1-worklog/1.7-week7/><b>1.7. </b>Nhật ký Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Nhật ký Tuần 8" class=dd-item><a href=../../../vi/1-worklog/1.8-week8/><b>1.8. </b>Nhật ký Tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Nhật ký Tuần 9" class=dd-item><a href=../../../vi/1-worklog/1.9-week9/><b>1.9. </b>Nhật ký Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Nhật ký Tuần 10" class=dd-item><a href=../../../vi/1-worklog/1.10-week10/><b>1.10. </b>Nhật ký Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Nhật ký Tuần 11" class=dd-item><a href=../../../vi/1-worklog/1.11-week11/><b>1.11. </b>Nhật ký Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Nhật ký Tuần 12" class=dd-item><a href=../../../vi/1-worklog/1.12-week12/><b>1.12. </b>Nhật ký Tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title=Proposal class=dd-item><a href=../../../vi/2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài blogs đã dịch" class="dd-item
parent"><a href=../../../vi/3-blogstranslated/><b>3. </b>Các bài blogs đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../../vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" class="dd-item
active"><a href=../../../vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../../vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../../vi/4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="AWS Cloud Day Vietnam - AI Edition 2025" class=dd-item><a href=../../../vi/4-eventparticipated/4.1-event1/><b>4.1. </b>AWS Cloud Day Vietnam - AI Edition 2025
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Khám Phá Agentic AI – Workshop Amazon QuickSuite" class=dd-item><a href=../../../vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Khám Phá Agentic AI – Workshop Amazon QuickSuite
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="AWS Cloud Mastery Series #3 - Chuyên sâu về Trụ cột Bảo mật" class=dd-item><a href=../../../vi/4-eventparticipated/4.3-event3/><b>4.3. </b>AWS Cloud Mastery Series #3 - Chuyên sâu về Trụ cột Bảo mật
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.4-event4/ title="AWS Cloud Mastery Series #2 - DevOps trên AWS" class=dd-item><a href=../../../vi/4-eventparticipated/4.4-event4/><b>4.4. </b>AWS Cloud Mastery Series #2 - DevOps trên AWS
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=../../../vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-introduction/ title="5.1 Introduction" class=dd-item><a href=../../../vi/5-workshop/5.1-introduction/><b>5.1. </b>5.1 Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-perequisites/ title="5.2 Prerequisites" class=dd-item><a href=../../../vi/5-workshop/5.2-perequisites/><b>5.2. </b>5.2 Prerequisites
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-setup-cognito/ title="5.3 Setup Cognito" class=dd-item><a href=../../../vi/5-workshop/5.3-setup-cognito/><b>5.3. </b>5.3 Setup Cognito
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-setup-lambda/ title="Module 4: Setup Lambda" class=dd-item><a href=../../../vi/5-workshop/5.4-setup-lambda/><b>5.4. </b>Module 4: Setup Lambda
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.5-setup-api-gateway/ title="5.5 Setup API Gateway" class=dd-item><a href=../../../vi/5-workshop/5.5-setup-api-gateway/><b>5.5. </b>5.5 Setup API Gateway
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.6-setup-rds-database/ title="5.6 Setup RDS Database" class=dd-item><a href=../../../vi/5-workshop/5.6-setup-rds-database/><b>5.6. </b>5.6 Setup RDS Database
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.7-setup-s3-cloudfront/ title="5.7 Setup S3 + CloudFront" class=dd-item><a href=../../../vi/5-workshop/5.7-setup-s3-cloudfront/><b>5.7. </b>5.7 Setup S3 + CloudFront
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.8-setup-vpc-security/ title="5.8 Setup VPC & Security" class=dd-item><a href=../../../vi/5-workshop/5.8-setup-vpc-security/><b>5.8. </b>5.8 Setup VPC & Security
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.9-monitoring-logging/ title="5.9 Monitoring & Logging" class=dd-item><a href=../../../vi/5-workshop/5.9-monitoring-logging/><b>5.9. </b>5.9 Monitoring & Logging
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.10-cleanup/ title="5.10 Cleanup & Cost Optimization" class=dd-item><a href=../../../vi/5-workshop/5.10-cleanup/><b>5.10. </b>5.10 Cleanup & Cost Optimization
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=../../../vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=../../../vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://masterltb.github.io/profile/3-blogstranslated/3.2-blog2/>English</option><option id=vi value=https://masterltb.github.io/profile/vi/3-blogstranslated/3.2-blog2/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../../vi/>Báo cáo thực tập</a> > <a href=../../../vi/3-blogstranslated/>Các bài blogs đã dịch</a> > Blog 2</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#tổng-quan-về-giải-pháp>Tổng quan về giải pháp</a></li><li><a href=#các-điều-kiện-tiên-quyết>Các điều kiện tiên quyết</a></li><li><a href=#ví-dụ-thực-hành-phòng-chống-gian-lận-thời-gian-thực-với-bộ-dữ-liệu-ieee-cis>Ví dụ thực hành: Phòng chống gian lận thời gian thực với bộ dữ liệu IEEE-CIS</a><ul><li><a href=#tổng-quan-về-bộ-dữ-liệu-và-nhiệm-vụ>Tổng quan về bộ dữ liệu và nhiệm vụ</a></li><li><a href=#bước-0-thiết-lập-môi-trường>Bước 0: Thiết lập môi trường</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 2</h1><h1 id=hiện-đại-hóa-việc-phòng-chống-gian-lận-graphstorm-v05-cho-suy-luận-thời-gian-thực>Hiện đại hóa việc phòng chống gian lận: GraphStorm v0.5 cho suy luận thời gian thực</h1><p>Gian lận tiếp tục gây ra thiệt hại tài chính đáng kể trên toàn cầu, chỉ riêng người tiêu dùng Hoa Kỳ đã mất 12,5 tỷ USD vào năm 2024—tăng 25% so với năm trước theo Ủy ban Thương mại Liên bang. Sự gia tăng này không xuất phát từ các cuộc tấn công thường xuyên hơn, mà từ sự tinh vi ngày càng tăng của những kẻ gian lận. Khi các hoạt động gian lận trở nên phức tạp và kết nối với nhau hơn, các phương pháp machine learning thông thường tỏ ra yếu kém do chỉ phân tích các giao dịch một cách riêng lẻ, không thể nắm bắt được mạng lưới các hoạt động phối hợp đặc trưng cho các âm mưu gian lận hiện đại.</p><p>Graph neural networks (GNNs) giải quyết hiệu quả thách thức này bằng cách mô hình hóa các mối quan hệ giữa các thực thể—chẳng hạn như người dùng chia sẻ thiết bị, vị trí hoặc phương thức thanh toán. Bằng cách phân tích cả cấu trúc mạng lưới và thuộc tính của thực thể, GNNs có hiệu quả trong việc xác định các âm mưu gian lận tinh vi nơi thủ phạm che giấu các hoạt động đáng ngờ riêng lẻ nhưng để lại dấu vết trong mạng lưới quan hệ của chúng. Tuy nhiên, việc triển khai phòng chống gian lận trực tuyến dựa trên GNN trong môi trường production đặt ra những thách thức đặc thù: đạt được phản hồi inference dưới một giây, mở rộng quy mô đến hàng tỷ nodes và edges, và duy trì hiệu quả vận hành cho các bản cập nhật mô hình. Trong bài đăng này, chúng tôi chỉ cho bạn cách vượt qua những thách thức này bằng cách sử dụng GraphStorm, đặc biệt là các khả năng real-time inference mới của GraphStorm v0.5.</p><p>Các giải pháp trước đây đòi hỏi sự đánh đổi (tradeoffs) giữa khả năng và sự đơn giản. Cách tiếp cận DGL ban đầu của chúng tôi cung cấp các khả năng real-time toàn diện nhưng đòi hỏi việc điều phối dịch vụ (service orchestration) phức tạp—bao gồm việc cập nhật thủ công các cấu hình endpoint và định dạng payload sau khi huấn luyện lại với các hyperparameters mới. Cách tiếp cận này cũng thiếu sự linh hoạt của mô hình, đòi hỏi phải tùy chỉnh các mô hình và cấu hình GNN khi sử dụng các kiến trúc ngoài relational graph convolutional networks (RGCN). Các triển khai DGL in-memory sau đó đã giảm bớt sự phức tạp nhưng gặp phải những hạn chế về khả năng mở rộng (scalability) với khối lượng dữ liệu cấp doanh nghiệp. Chúng tôi đã xây dựng GraphStorm để thu hẹp khoảng cách này, bằng cách giới thiệu distributed training và các APIs cấp cao giúp đơn giản hóa việc phát triển GNN ở quy mô doanh nghiệp (enterprise scale).</p><p>Trong một bài đăng blog gần đây, chúng tôi đã minh họa khả năng và sự đơn giản trong việc huấn luyện mô hình GNN quy mô doanh nghiệp và offline inference của GraphStorm. Mặc dù phát hiện gian lận bằng GNN ngoại tuyến (offline) có thể xác định các giao dịch gian lận sau khi chúng xảy ra—việc ngăn chặn tổn thất tài chính đòi hỏi phải chặn đứng gian lận trước khi nó xảy ra. GraphStorm v0.5 hiện thực hóa điều này thông qua hỗ trợ real-time inference gốc qua Amazon SageMaker AI. GraphStorm v0.5 mang đến hai cải tiến: triển khai endpoint được tinh giản giúp giảm nhiều tuần kỹ thuật tùy chỉnh—lập trình các tệp entry point của SageMaker, đóng gói các model artifacts, và gọi các APIs triển khai của SageMaker—xuống còn một thao tác lệnh duy nhất, và đặc tả payload được tiêu chuẩn hóa giúp đơn giản hóa việc tích hợp của client với các dịch vụ real-time inference. Những khả năng này cho phép thực hiện các tác vụ node classification dưới một giây như phòng chống gian lận, giúp các tổ chức chủ động chống lại mối đe dọa gian lận bằng các giải pháp GNN có khả năng mở rộng và vận hành đơn giản.</p><p>Để giới thiệu những khả năng này, bài đăng này trình bày một giải pháp phòng chống gian lận. Thông qua giải pháp này, chúng tôi chỉ ra cách một data scientist có thể chuyển đổi một mô hình GNN đã được huấn luyện sang các inference endpoints sẵn sàng cho production với chi phí vận hành tối thiểu. Nếu bạn quan tâm đến việc triển khai các mô hình dựa trên GNN để phòng chống gian lận thời gian thực hoặc các trường hợp kinh doanh (business cases) tương tự, bạn có thể điều chỉnh các phương pháp được trình bày ở đây để tạo ra giải pháp của riêng mình.</p><h2 id=tổng-quan-về-giải-pháp>Tổng quan về giải pháp</h2><p>Giải pháp được đề xuất của chúng tôi là một quy trình (pipeline) 4 bước như được hiển thị trong hình sau. Quy trình bắt đầu ở bước 1 với việc xuất biểu đồ giao dịch từ cơ sở dữ liệu đồ thị xử lý giao dịch trực tuyến (OLTP) sang bộ nhớ có khả năng mở rộng (Amazon Simple Storage Service (Amazon S3) hoặc Amazon EFS), tiếp theo là huấn luyện mô hình phân tán ở bước 2. Bước 3 là quy trình triển khai đơn giản hóa của GraphStorm v0.5, tạo ra các real-time inference endpoints của SageMaker bằng một lệnh duy nhất. Sau khi SageMaker AI đã triển khai endpoint thành công, một ứng dụng client tích hợp với cơ sở dữ liệu đồ thị OLTP để xử lý các luồng giao dịch trực tiếp ở bước 4. Bằng cách truy vấn cơ sở dữ liệu đồ thị, client chuẩn bị các đồ thị con (subgraphs) xung quanh các giao dịch cần dự đoán, chuyển đổi đồ thị con thành định dạng payload được tiêu chuẩn hóa, và gọi endpoint đã được triển khai để dự đoán thời gian thực.</p><p>Để cung cấp chi tiết triển khai cụ thể cho từng bước trong giải pháp real-time inference, chúng tôi minh họa luồng công việc hoàn chỉnh bằng cách sử dụng nhiệm vụ phát hiện gian lận IEEE-CIS có sẵn công khai.</p><p>Lưu ý: Ví dụ này sử dụng một Jupyter notebook làm bộ điều khiển cho toàn bộ quy trình bốn bước để cho đơn giản. Để có thiết kế sẵn sàng cho production hơn, hãy xem kiến trúc được mô tả trong Build a GNN-based real-time fraud detection solution.</p><h2 id=các-điều-kiện-tiên-quyết>Các điều kiện tiên quyết</h2><p>Để chạy ví dụ này, bạn cần có một <a href="https://signin.aws.amazon.com/signup?request_type=register">tài khoản AWS</a> mà mã <a href=https://aws.amazon.com/cdk/>AWS Cloud Development Kit (AWS CDK)</a> của ví dụ sử dụng để tạo các tài nguyên cần thiết, bao gồm <a href=https://aws.amazon.com/vpc/>Amazon Virtual Private Cloud (Amazon VPC)</a>, cơ sở dữ liệu <a href=https://aws.amazon.com/neptune/>Amazon Neptune</a>, Amazon SageMaker AI, <a href=https://aws.amazon.com/ecr/>Amazon Elastic Container Registry (Amazon ECR)</a>, Amazon S3, cùng các roles và permission liên quan.</p><p>Lưu ý: Các tài nguyên này sẽ phát sinh chi phí trong quá trình thực thi (khoảng 6 USD mỗi giờ với cài đặt mặc định). Hãy theo dõi việc sử dụng một cách cẩn thận và xem lại các trang giá cho những dịch vụ này trước khi tiếp tục. Làm theo hướng dẫn dọn dẹp ở cuối để tránh các khoản phí phát sinh liên tục.</p><h2 id=ví-dụ-thực-hành-phòng-chống-gian-lận-thời-gian-thực-với-bộ-dữ-liệu-ieee-cis>Ví dụ thực hành: Phòng chống gian lận thời gian thực với bộ dữ liệu IEEE-CIS</h2><p>Toàn bộ mã triển khai cho ví dụ này, bao gồm các Jupyter notebook và các tệp kịch bản Python hỗ trợ, hiện có sẵn trong kho lưu trữ (repository) công khai của chúng tôi. Kho lưu trữ này cung cấp một bản triển khai end-to-end hoàn chỉnh mà bạn có thể trực tiếp thực thi và điều chỉnh cho các trường hợp sử dụng (use cases) phòng chống gian lận của riêng bạn.</p><h3 id=tổng-quan-về-bộ-dữ-liệu-và-nhiệm-vụ>Tổng quan về bộ dữ liệu và nhiệm vụ</h3><p>Ví dụ này sử dụng bộ dữ liệu phát hiện gian lận IEEE-CIS, chứa 500.000 giao dịch đã được ẩn danh với khoảng 3,5% là các trường hợp gian lận. Bộ dữ liệu bao gồm 392 thuộc tính dạng phân loại (categorical) và dạng số (numerical), với các thuộc tính chính như loại thẻ, loại sản phẩm, địa chỉ, và tên miền email tạo thành cấu trúc đồ thị (graph structure) được hiển thị trong hình sau. Mỗi giao dịch (với một nhãn isFraud) kết nối đến các thực thể Loại thẻ, Vị trí, Loại sản phẩm, và tên miền email của Người mua và Người nhận, tạo ra một đồ thị không đồng nhất (heterogeneous graph) cho phép các mô hình GNN phát hiện các mẫu gian lận thông qua các mối quan hệ giữa các thực thể.</p><p>Khác với bài đăng trước của chúng tôi đã minh họa về GraphStorm cùng với <a href=https://aws.amazon.com/neptune/>Amazon Neptune Analytics</a> cho các luồng công việc phân tích ngoại tuyến (offline), ví dụ này sử dụng cơ sở dữ liệu Neptune làm kho lưu trữ đồ thị OLTP, được tối ưu hóa cho việc trích xuất đồ thị con (subgraph) nhanh chóng cần thiết trong quá trình real-time inference. Dựa trên thiết kế đồ thị, dữ liệu IEEE-CIS dạng bảng được chuyển đổi thành một bộ tệp CSV tương thích với định dạng của cơ sở dữ liệu Neptune, cho phép tải trực tiếp vào cả cơ sở dữ liệu Neptune và quy trình huấn luyện mô hình GNN của GraphStorm chỉ với một bộ tệp duy nhất.</p><h3 id=bước-0-thiết-lập-môi-trường>Bước 0: Thiết lập môi trường</h3><p>Bước 0 thiết lập môi trường chạy cần thiết cho quy trình (pipeline) phòng chống gian lận bốn bước. Hướng dẫn thiết lập hoàn chỉnh có sẵn trong kho lưu trữ (repository) triển khai.</p><p>Để chạy giải pháp ví dụ, bạn cần triển khai một <a href=https://aws.amazon.com/cloudformation/>AWS CloudFormation stack</a> thông qua AWS CDK. Stack này tạo ra Neptune DB instance, VPC để đặt nó vào, và các roles và security groups phù hợp. Nó còn tạo thêm một SageMaker AI notebook instance, từ đó bạn chạy các notebook ví dụ đi kèm với repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone <span style=color:#f92672>[</span>https://github.com/aws-samples/amazon-neptune-samples.git<span style=color:#f92672>](</span>https://github.com/aws-samples/amazon-neptune-samples.git<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd neptune-database-graphstorm-online-inference/neptune-db-cdk
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Ensure you have CDK installed and have appropriate credentials set up</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cdk deploy
</span></span><span style=display:flex><span>Khi việc triển khai <span style=color:#f92672>(</span>deployment<span style=color:#f92672>)</span> hoàn tất <span style=color:#f92672>(</span>mất khoảng <span style=color:#ae81ff>10</span> phút để các tài nguyên cần thiết sẵn sàng<span style=color:#f92672>)</span>, AWS CDK sẽ in ra một vài kết quả đầu ra <span style=color:#f92672>(</span>outputs<span style=color:#f92672>)</span>, một trong số đó là tên của SageMaker notebook instance mà bạn sử dụng để chạy qua các notebooks:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example output</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NeptuneInfraStack.NotebookInstanceName <span style=color:#f92672>=</span> arn:aws:sagemaker:us-east-1:012345678912:notebook-instance/NeptuneNotebook-9KgSB9XXXXXX
</span></span><span style=display:flex><span>Bạn có thể điều hướng đến giao diện người dùng <span style=color:#f92672>(</span>UI<span style=color:#f92672>)</span> của SageMaker AI notebook, tìm notebook instance tương ứng, và chọn liên kết Open Jupyterlab của nó để truy cập notebook.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Một cách khác là, bạn có thể sử dụng AWS Command Line Interface <span style=color:#f92672>(</span>AWS CLI<span style=color:#f92672>)</span> để nhận một URL đã được ký trước <span style=color:#f92672>(</span>pre-signed URL<span style=color:#f92672>)</span> để truy cập notebook. Bạn sẽ cần thay thế &lt;notebook-instance-name&gt; bằng tên notebook instance thực tế.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws sagemaker create-presigned-notebook-instance-url --notebook-instance-name &lt;notebook-instance-name&gt;
</span></span><span style=display:flex><span>Khi bạn đang ở trong giao diện web console của notebook instance, hãy mở notebook đầu tiên, 0-Data-Preparation.ipynb, để bắt đầu đi qua ví dụ.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bước 1: Xây dựng đồ thị
</span></span><span style=display:flex><span>Trong Notebook 0-Data-Preparation, bạn chuyển đổi bộ dữ liệu IEEE-CIS dạng bảng thành cấu trúc đồ thị không đồng nhất <span style=color:#f92672>(</span>heterogeneous graph structure<span style=color:#f92672>)</span> được hiển thị trong hình ở đầu phần này. Jupyter Notebook được cung cấp sẽ trích xuất các thực thể từ các thuộc tính <span style=color:#f92672>(</span>features<span style=color:#f92672>)</span> của giao dịch, tạo ra các node Loại thẻ từ các thuộc tính card1–card6, các node Người mua và Người nhận từ các tên miền email, các node Loại sản phẩm từ mã sản phẩm, và các node Vị trí từ thông tin địa lý. Quá trình chuyển đổi này thiết lập các mối quan hệ giữa các giao dịch và những thực thể này, tạo ra dữ liệu đồ thị ở định dạng nhập của Neptune <span style=color:#f92672>(</span>Neptune import format<span style=color:#f92672>)</span> để nhập trực tiếp vào kho lưu trữ đồ thị OLTP. Hàm create_neptune_db_data<span style=color:#f92672>()</span> điều phối quá trình trích xuất thực thể và tạo mối quan hệ này trên tất cả các loại node <span style=color:#f92672>(</span>mất khoảng <span style=color:#ae81ff>30</span> giây<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GRAPH_NAME <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ieee-cis-fraud-detection&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PROCESSED_PREFIX <span style=color:#f92672>=</span> f<span style=color:#e6db74>&#34;./{GRAPH_NAME}&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ID_COLS <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;card1,card2,card3,card4,card5,card6,ProductCD,addr1,addr2,P_emaildomain,R_emaildomain&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CAT_COLS <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;M1,M2,M3,M4,M5,M6,M7,M8,M9&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Lists of columns to keep from each file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>COLS_TO_KEEP <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;transaction.csv&#34;</span>: <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ID_COLS.split<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;,&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>+ CAT_COLS.split<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;,&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>+
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Numerical features without missing values</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>f<span style=color:#e6db74>&#34;C{idx}&#34;</span> <span style=color:#66d9ef>for</span> idx in range<span style=color:#f92672>(</span>1, 15<span style=color:#f92672>)]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>+ <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;TransactionID&#34;</span>, <span style=color:#e6db74>&#34;TransactionAmt&#34;</span>, <span style=color:#e6db74>&#34;TransactionDT&#34;</span>, <span style=color:#e6db74>&#34;isFraud&#34;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;identity.csv&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;TransactionID&#34;</span>, <span style=color:#e6db74>&#34;DeviceType&#34;</span><span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>create_neptune_db_data<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data_prefix<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;./input-data/&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>output_prefix<span style=color:#f92672>=</span>PROCESSED_PREFIX,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>id_cols<span style=color:#f92672>=</span>ID_COLS,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat_cols<span style=color:#f92672>=</span>CAT_COLS,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cols_to_keep<span style=color:#f92672>=</span>COLS_TO_KEEP,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>num_chunks<span style=color:#f92672>=</span>1,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Notebook này cũng tạo ra tệp cấu hình JSON cần thiết cho lệnh GConstruct của GraphStorm và thực thi quy trình xây dựng đồ thị. Lệnh GConstruct này chuyển đổi dữ liệu có định dạng Neptune thành một định dạng đồ thị nhị phân phân tán <span style=color:#f92672>(</span>distributed binary graph format<span style=color:#f92672>)</span> được tối ưu hóa cho quy trình <span style=color:#f92672>(</span>pipeline<span style=color:#f92672>)</span> huấn luyện của GraphStorm, có chức năng phân chia cấu trúc đồ thị không đồng nhất <span style=color:#f92672>(</span>heterogeneous graph structure<span style=color:#f92672>)</span> trên các nút tính toán <span style=color:#f92672>(</span>compute nodes<span style=color:#f92672>)</span> để cho phép huấn luyện mô hình có khả năng mở rộng trên các đồ thị quy mô công nghiệp <span style=color:#f92672>(</span>được đo bằng hàng tỷ nodes và edges<span style=color:#f92672>)</span>. Đối với dữ liệu IEEE-CIS, lệnh GConstruct mất <span style=color:#ae81ff>90</span> giây để hoàn thành.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Trong Notebook 1-Load-Data-Into-Neptune-DB, bạn tải dữ liệu CSV vào Neptune database instance <span style=color:#f92672>(</span>mất khoảng <span style=color:#ae81ff>9</span> phút<span style=color:#f92672>)</span>, việc này giúp chúng có sẵn cho online inference. Trong quá trình online inference, sau khi chọn một node giao dịch, bạn truy vấn cơ sở dữ liệu Neptune để lấy vùng lân cận đồ thị <span style=color:#f92672>(</span>graph neighborhood<span style=color:#f92672>)</span> của node mục tiêu, truy xuất các thuộc tính <span style=color:#f92672>(</span>features<span style=color:#f92672>)</span> của mọi node trong vùng lân cận và cấu trúc đồ thị con <span style=color:#f92672>(</span>subgraph structure<span style=color:#f92672>)</span> xung quanh mục tiêu.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bước 2: Huấn luyện mô hình
</span></span><span style=display:flex><span>Sau khi bạn đã chuyển đổi dữ liệu sang định dạng đồ thị nhị phân phân tán <span style=color:#f92672>(</span>distributed binary graph format<span style=color:#f92672>)</span>, đã đến lúc huấn luyện một mô hình GNN. GraphStorm cung cấp các kịch bản dòng lệnh <span style=color:#f92672>(</span>command-line scripts<span style=color:#f92672>)</span> để huấn luyện một mô hình mà không cần viết mã. Trong Notebook 2-Model-Training, bạn huấn luyện một mô hình GNN sử dụng lệnh phân loại node <span style=color:#f92672>(</span>node classification<span style=color:#f92672>)</span> của GraphStorm với cấu hình được quản lý thông qua các tệp YAML. Cấu hình cơ bản xác định một mô hình RGCN hai lớp với các lớp ẩn <span style=color:#ae81ff>128</span> chiều, huấn luyện trong <span style=color:#ae81ff>4</span> epochs với learning rate là 0.001 và batch size là 1024, mất khoảng <span style=color:#ae81ff>100</span> giây cho <span style=color:#ae81ff>1</span> epoch huấn luyện và đánh giá mô hình trên một instance ml.m5.4xlarge. Để cải thiện độ chính xác của việc phát hiện gian lận, notebook cung cấp các cấu hình mô hình nâng cao hơn như lệnh dưới đây.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>!python -m graphstorm.run.gs_node_classification <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--workspace ./ <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--part-config ieee_gs/ieee-cis.json <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--num-trainers <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--cf ieee_nc.yaml <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--eval-metric roc_auc <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--save-model-path ./model-simple/ <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--topk-model-to-save <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--imbalance-class-weights 0.1,1.0
</span></span><span style=display:flex><span>Các đối số trong lệnh này giải quyết thách thức về sự mất cân bằng nhãn <span style=color:#f92672>(</span>label imbalance<span style=color:#f92672>)</span> của bộ dữ liệu, nơi chỉ có 3,5% giao dịch là gian lận, bằng cách sử dụng AUC-ROC làm thước đo đánh giá <span style=color:#f92672>(</span>evaluation metric<span style=color:#f92672>)</span> và sử dụng trọng số lớp <span style=color:#f92672>(</span>class weights<span style=color:#f92672>)</span>. Lệnh này cũng lưu mô hình hoạt động tốt nhất cùng với các tệp cấu hình thiết yếu cần thiết cho việc triển khai endpoint. Các cấu hình nâng cao có thể nâng cao hơn nữa hiệu suất của mô hình thông qua các kỹ thuật như HGT encoders, multi-head attention, và hàm mất mát class-weighted cross entropy, mặc dù những tối ưu hóa này làm tăng yêu cầu tính toán. GraphStorm cho phép thực hiện những thay đổi này thông qua các đối số lúc chạy <span style=color:#f92672>(</span>run time arguments<span style=color:#f92672>)</span> và các cấu hình YAML, làm giảm nhu cầu sửa đổi mã.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bước 3: Triển khai endpoint thời gian thực
</span></span><span style=display:flex><span>Trong Notebook 3-GraphStorm-Endpoint-Deployment, bạn triển khai endpoint thời gian thực thông qua kịch bản khởi chạy <span style=color:#f92672>(</span>launch script<span style=color:#f92672>)</span> đơn giản của GraphStorm v0.5. Việc triển khai đòi hỏi ba model artifacts được tạo ra trong quá trình huấn luyện: tệp mô hình đã lưu chứa các trọng số, tệp JSON xây dựng đồ thị đã được cập nhật với metadata biến đổi thuộc tính, và tệp YAML cấu hình huấn luyện được cập nhật lúc chạy. Những artifacts này cho phép GraphStorm tái tạo lại chính xác các cấu hình huấn luyện và mô hình để có hành vi inference nhất quán. Đáng chú ý, tệp JSON xây dựng đồ thị và tệp YAML cấu hình huấn luyện đã được cập nhật chứa các cấu hình quan trọng, thiết yếu để khôi phục mô hình đã được huấn luyện trên endpoint và xử lý các payload yêu cầu đến. Việc sử dụng các tệp JSON và YAML đã được cập nhật cho việc triển khai endpoint là rất quan trọng.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GraphStorm sử dụng tính năng bring your own container <span style=color:#f92672>(</span>BYOC<span style=color:#f92672>)</span> của SageMaker AI để triển khai một môi trường inference nhất quán. Bạn cần xây dựng và đẩy <span style=color:#f92672>(</span>push<span style=color:#f92672>)</span> Docker image thời gian thực của GraphStorm lên Amazon ECR bằng cách sử dụng các kịch bản shell <span style=color:#f92672>(</span>shell scripts<span style=color:#f92672>)</span> được cung cấp. Cách tiếp cận container hóa này cung cấp các môi trường chạy <span style=color:#f92672>(</span>runtime environments<span style=color:#f92672>)</span> nhất quán tương thích với cơ sở hạ tầng được quản lý của SageMaker AI. Docker image chứa các phụ thuộc cần thiết cho các khả năng real-time inference của GraphStorm trên môi trường triển khai.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Để triển khai endpoint, bạn có thể sử dụng kịch bản <span style=color:#f92672>(</span>script<span style=color:#f92672>)</span> launch_realtime_endpoint.py <span style=color:#66d9ef>do</span> GraphStorm cung cấp, giúp bạn thu thập các artifacts cần thiết và tạo ra các tài nguyên SageMaker AI cần thiết để triển khai một endpoint. Script này chấp nhận URI của image trên Amazon ECR, IAM role, đường dẫn đến các model artifact, và cấu hình S3 bucket, tự động xử lý việc cấp phát <span style=color:#f92672>(</span>provisioning<span style=color:#f92672>)</span> và cấu hình endpoint. Theo mặc định, script sẽ đợi cho việc triển khai endpoint hoàn tất trước khi thoát. Khi hoàn tất, nó sẽ in ra tên và Khu vực AWS <span style=color:#f92672>(</span>AWS Region<span style=color:#f92672>)</span> của endpoint đã được triển khai cho các yêu cầu inference sau đó. Bạn sẽ cần phải thay thế các trường được đặt trong &lt;&gt; bằng các giá trị thực tế của môi trường của bạn.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>!python ~/graphstorm/sagemaker/launch/launch_realtime_endpoint.py <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--image-uri &lt;account_id&gt;.dkr.ecr.&lt;aws_region&gt;<span style=color:#f92672>[</span>.amazonaws.com/graphstorm:sagemaker-endpoint-cpu<span style=color:#f92672>](</span>https://.amazonaws.com/graphstorm:sagemaker-endpoint-cpu<span style=color:#f92672>)</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--role arn:aws:iam::&lt;account_id&gt;:role/&lt;your_role&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--region &lt;aws_region&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--restore-model-path &lt;restore-model-path&gt;/models/epoch-1/ <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--model-yaml-config-file &lt;restore-model-path&gt;/models/GRAPHSTORM_RUNTIME_UPDATED_TRAINING_CONFIG.yaml <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--graph-json-config-file &lt;restore-model-path&gt;/models/data_transform_new.json <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--infer-task-type node_classification <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--upload-tarfile-s3 s3://&lt;cdk-created-bucket&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>
</span></span><span style=display:flex><span>--model-name ieee-fraud-detect
</span></span><span style=display:flex><span>Bước 4: Real-time inference
</span></span><span style=display:flex><span>Trong Notebook 4-Sample-Graph-and-Invoke-Endpoint, bạn xây dựng một ứng dụng client cơ bản tích hợp với endpoint GraphStorm đã được triển khai để thực hiện phòng chống gian lận thời gian thực trên các giao dịch đến. Quy trình inference chấp nhận dữ liệu giao dịch thông qua các payload JSON được tiêu chuẩn hóa, thực hiện các dự đoán phân loại node <span style=color:#f92672>(</span>node classification<span style=color:#f92672>)</span> trong vài trăm mili giây, và trả về điểm xác suất gian lận cho phép đưa ra quyết định ngay lập tức.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Một lời gọi inference end-to-end cho một node đã tồn tại trong đồ thị có ba giai đoạn riêng biệt:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Lấy mẫu đồ thị <span style=color:#f92672>(</span>Graph sampling<span style=color:#f92672>)</span> từ cơ sở dữ liệu Neptune. Đối với một node mục tiêu đã cho đã tồn tại trong đồ thị, truy xuất vùng lân cận k-hop của nó với một giới hạn fanout, tức là giới hạn số lượng hàng xóm được truy xuất ở mỗi hop bằng một ngưỡng.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Chuẩn bị payload cho inference. Neptune trả về các đồ thị bằng GraphSON, một định dạng dữ liệu giống JSON chuyên dụng được sử dụng để mô tả dữ liệu đồ thị. Ở bước này, bạn cần chuyển đổi GraphSON được trả về sang đặc tả JSON của riêng GraphStorm. Bước này được thực hiện trên client thực hiện inference, trong trường hợp này là một SageMaker notebook instance.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Thực hiện Model inference bằng một SageMaker endpoint. Sau khi payload được chuẩn bị, bạn gửi một yêu cầu inference đến một SageMaker endpoint đã tải một model snapshot đã được huấn luyện trước đó. Endpoint nhận yêu cầu, thực hiện bất kỳ phép biến đổi thuộc tính nào cần thiết <span style=color:#f92672>(</span>chẳng hạn như chuyển đổi các thuộc tính dạng phân loại <span style=color:#f92672>(</span>categorical<span style=color:#f92672>)</span> sang mã hóa one-hot <span style=color:#f92672>(</span>one-hot encoding<span style=color:#f92672>))</span>, tạo biểu diễn đồ thị nhị phân trong bộ nhớ, và đưa ra dự đoán cho node mục tiêu bằng cách sử dụng vùng lân cận đồ thị và các trọng số mô hình đã được huấn luyện. Phản hồi được mã hóa thành JSON và gửi lại cho client.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Một phản hồi ví dụ từ endpoint sẽ trông như sau:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>JSON
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;status_code&#34;</span>: 200,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;request_uid&#34;</span>: <span style=color:#e6db74>&#34;877042dbc361fc33&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;Request processed successfully.&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;data&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;results&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;node_type&#34;</span>: <span style=color:#e6db74>&#34;Transaction&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;node_id&#34;</span>: <span style=color:#e6db74>&#34;2991260&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;prediction&#34;</span>: <span style=color:#f92672>[</span>0.995966911315918, 0.004033133387565613<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>Dữ liệu quan tâm cho giao dịch đơn lẻ mà bạn đã dự đoán nằm trong khóa <span style=color:#f92672>(</span>key<span style=color:#f92672>)</span> prediction và node_id. tương ứng. Kết quả dự đoán cung cấp cho bạn điểm số thô <span style=color:#f92672>(</span>raw scores<span style=color:#f92672>)</span> mà mô hình tạo ra cho lớp <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>hợp lệ<span style=color:#f92672>)</span> và lớp <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>gian lận<span style=color:#f92672>)</span> tại các chỉ số <span style=color:#f92672>(</span>indexes<span style=color:#f92672>)</span> <span style=color:#ae81ff>0</span> và <span style=color:#ae81ff>1</span> tương ứng của danh sách predictions. Trong ví dụ này, mô hình đánh dấu giao dịch này là có khả năng cao là hợp lệ. Bạn có thể tìm thấy đặc tả phản hồi đầy đủ của GraphStorm trong tài liệu của GraphStorm.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Các ví dụ triển khai hoàn chỉnh, bao gồm mã client và các đặc tả payload, được cung cấp trong kho lưu trữ <span style=color:#f92672>(</span>repository<span style=color:#f92672>)</span> để hướng dẫn việc tích hợp với các hệ thống production.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Dọn dẹp
</span></span><span style=display:flex><span>Để ngừng phát sinh chi phí trên tài khoản của bạn, bạn cần xóa các tài nguyên AWS mà bạn đã tạo bằng AWS CDK tại bước Thiết lập Môi trường <span style=color:#f92672>(</span>Environment Setup<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Trước tiên, bạn phải xóa SageMaker endpoint được tạo trong Bước <span style=color:#ae81ff>3</span> để lệnh cdk destroy có thể hoàn thành. Hãy xem mục Delete Endpoints and Resources để biết thêm các tùy chọn xóa một endpoint. Khi xong, bạn có thể chạy lệnh sau từ thư mục gốc của repository:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd neptune-database-graphstorm-online-inference/neptune-db-cdk
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cdk destroy
</span></span><span style=display:flex><span>Xem tài liệu của AWS CDK để biết thêm thông tin về cách sử dụng cdk destroy, hoặc xem tài liệu của CloudFormation để biết cách xóa một stack từ giao diện người dùng console <span style=color:#f92672>(</span>console UI<span style=color:#f92672>)</span>. Theo mặc định, lệnh cdk destroy không xóa các model artifacts và dữ liệu đồ thị đã xử lý được lưu trữ trong S3 bucket trong quá trình huấn luyện và triển khai. Bạn phải xóa chúng theo cách thủ công. Hãy xem mục Deleting a general purpose bucket để biết thông tin về cách làm trống và xóa một S3 bucket mà AWS CDK đã tạo.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Kết luận
</span></span><span style=display:flex><span>Graph neural networks giải quyết các thách thức phòng chống gian lận phức tạp bằng cách mô hình hóa các mối quan hệ giữa các thực thể mà các phương pháp machine learning truyền thống bỏ lỡ khi phân tích các giao dịch một cách riêng lẻ. GraphStorm v0.5 giúp đơn giản hóa việc triển khai real-time inference của GNN với một lệnh duy nhất để tạo endpoint, việc mà trước đây đòi hỏi sự phối hợp của nhiều dịch vụ, và một đặc tả payload được tiêu chuẩn hóa giúp đơn giản hóa việc tích hợp của client với các dịch vụ real-time inference. Các tổ chức giờ đây có thể triển khai các endpoint phòng chống gian lận quy mô doanh nghiệp thông qua các lệnh được tinh giản, giúp giảm công sức kỹ thuật tùy chỉnh từ hàng tuần xuống còn các thao tác một lệnh duy nhất.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Để triển khai phòng chống gian lận dựa trên GNN với dữ liệu của riêng bạn:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Xem lại tài liệu của GraphStorm để biết các tùy chọn cấu hình mô hình và các đặc tả triển khai.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Điều chỉnh ví dụ IEEE-CIS này cho bộ dữ liệu phòng chống gian lận của bạn bằng cách sửa đổi các bước xây dựng đồ thị và kỹ thuật thuộc tính <span style=color:#f92672>(</span>feature engineering<span style=color:#f92672>)</span>, sử dụng mã nguồn và các bài hướng dẫn hoàn chỉnh có sẵn trong kho lưu trữ GitHub của chúng tôi.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Truy cập hướng dẫn triển khai từng bước để xây dựng các giải pháp phòng chống gian lận sẵn sàng cho production với các khả năng nâng cao của GraphStorm v0.5 bằng cách sử dụng dữ liệu doanh nghiệp của bạn.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author Jian Zhang — Nhà khoa học ứng dụng cấp cao, người đã sử dụng các kỹ thuật machine learning để giúp khách hàng giải quyết nhiều vấn đề khác nhau, chẳng hạn như phát hiện gian lận, tạo ảnh trang trí, và nhiều hơn nữa. Ông đã phát triển thành công các giải pháp machine learning dựa trên đồ thị, đặc biệt là graph neural network, cho các khách hàng ở Trung Quốc, Hoa Kỳ, và Singapore. Với vai trò là người truyền bá kiến thức về các khả năng đồ thị của AWS, Zhang đã có nhiều bài thuyết trình trước công chúng về GraphStorm, GNN, Deep Graph Library <span style=color:#f92672>(</span>DGL<span style=color:#f92672>)</span>, Amazon Neptune, và các dịch vụ AWS khác.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author Theodore Vasiloudis — Nhà khoa học ứng dụng cấp cao tại AWS, nơi ông làm việc về các hệ thống và thuật toán machine learning phân tán. Ông đã lãnh đạo việc phát triển GraphStorm Processing, thư viện xử lý đồ thị phân tán cho GraphStorm và là một nhà phát triển cốt lõi cho GraphStorm. Ông nhận bằng Tiến sĩ Khoa học Máy tính từ Viện Công nghệ Hoàng gia KTH, Stockholm, vào năm 2019.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author Xiang Song — Nhà khoa học ứng dụng cấp cao tại AWS AI Research and Education <span style=color:#f92672>(</span>AIRE<span style=color:#f92672>)</span>, nơi ông phát triển các framework deep learning bao gồm GraphStorm, DGL, và DGL-KE. Ông đã lãnh đạo việc phát triển Amazon Neptune ML, một khả năng mới của Neptune sử dụng graph neural networks cho các đồ thị được lưu trữ trong cơ sở dữ liệu đồ thị. Hiện ông đang lãnh đạo việc phát triển GraphStorm, một framework machine learning đồ thị nguồn mở cho các trường hợp sử dụng doanh nghiệp. Ông nhận bằng Tiến sĩ về hệ thống và kiến trúc máy tính tại Đại học Fudan, Thượng Hải, vào năm 2014.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author Florian Saupe — Giám đốc Sản phẩm Kỹ thuật Cấp cao tại bộ phận nghiên cứu AI/ML của AWS, hỗ trợ các nhóm khoa học như nhóm machine learning đồ thị, và các nhóm Hệ thống ML làm việc về huấn luyện phân tán quy mô lớn, inference, và khả năng chịu lỗi. Trước khi gia nhập AWS, Florian đã lãnh đạo mảng quản lý sản phẩm kỹ thuật cho lĩnh vực lái xe tự động tại Bosch, là một nhà tư vấn chiến lược tại McKinsey &amp; Company, và đã làm việc như một nhà khoa học về hệ thống điều khiển và robot—một lĩnh vực mà ông có bằng Tiến sĩ.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author Ozan Eken — Giám đốc Sản phẩm tại AWS, đam mê xây dựng các sản phẩm Generative AI và Graph Analytics tiên tiến. Với việc tập trung vào đơn giản hóa các thách thức dữ liệu phức tạp, Ozan giúp khách hàng khai phá những hiểu biết sâu sắc hơn và thúc đẩy sự đổi mới. Ngoài công việc, anh ấy thích thử các món ăn mới, khám phá các quốc gia khác nhau, và xem bóng đá.
</span></span></code></pre></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../../vi/3-blogstranslated/3.1-blog1/ title="Blog 1"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../../vi/3-blogstranslated/3.3-blog3/ title="Blog 3" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../../js/clipboard.min.js?1765283963></script><script src=../../../js/perfect-scrollbar.min.js?1765283963></script><script src=../../../js/perfect-scrollbar.jquery.min.js?1765283963></script><script src=../../../js/jquery.sticky.js?1765283963></script><script src=../../../js/featherlight.min.js?1765283963></script><script src=../../../js/highlight.pack.js?1765283963></script><script>hljs.initHighlightingOnLoad()</script><script src=../../../js/modernizr.custom-3.6.0.js?1765283963></script><script src=../../../js/learn.js?1765283963></script><script src=../../../js/hugo-learn.js?1765283963></script><link href=../../../mermaid/mermaid.css?1765283963 rel=stylesheet><script src=../../../mermaid/mermaid.js?1765283963></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>